<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מה ללבוש לבית הספר מחר?</title>
    <!-- PWA meta tags -->
    <meta name="description" content="אפליקציה לילדים שעוזרת להחליט מה ללבוש לבית הספר מחר לפי מזג האוויר">
    <meta name="theme-color" content="#4D96FF">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <style>
        :root {
            --primary: #4D96FF;
            --secondary: #FF6B6B;
            --accent: #FFD166;
            --background: #F8F9FA;
            --text: #343A40;
            --success: #6BCB77;
            --warning: #ff9800;
            --card-bg: white;
            --footer-bg: #f8f9fa;
        }
        
        [data-theme="dark"] {
            --primary: #375C99;
            --secondary: #A94848;
            --accent: #B59646;
            --background: #1F2329;
            --text: #E1E5EB;
            --success: #4D8A57;
            --warning: #B36A00;
            --card-bg: #2A303C;
            --footer-bg: #2A303C;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--background);
            color: var(--text);
            font-size: 18px;
            line-height: 1.6;
            padding-bottom: 30px;
            transition: background-color 0.3s, color 0.3s;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
        }
        
        .result {
            display: none;
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 0;
            margin-top: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            transition: background-color 0.3s;
        }
        
        .loading {
            text-align: center;
            margin: 40px 0;
            padding: 30px 20px;
            background-color: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            transition: background-color 0.3s;
        }
        
        .loading img {
            width: 80px;
            animation: spin 2s infinite linear;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .weather-info {
            text-align: center;
            padding: 25px 15px;
            position: relative;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            overflow: hidden;
        }
        
        .weather-info::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-size: cover;
            background-position: center;
            filter: brightness(0.85);
            z-index: -1;
            transition: all 0.5s;
        }
        
        .weather-info.clear::before {
            background-image: url('https://images.unsplash.com/photo-1579027989536-b7b1f875659b?q=80&w=1000');
            animation: sunny 15s infinite alternate;
        }
        
        .weather-info.clouds::before {
            background-image: url('https://images.unsplash.com/photo-1534088568595-a066f410bcda?q=80&w=1000');
            animation: cloudy 30s infinite alternate;
        }
        
        .weather-info.rain::before {
            background-image: url('https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?q=80&w=1000');
            animation: rainy 5s infinite linear;
        }
        
        .weather-info.drizzle::before {
            background-image: url('https://images.unsplash.com/photo-1541919329513-35f7af297129?q=80&w=1000');
            animation: rainy 8s infinite linear;
        }
        
        .weather-info.thunderstorm::before {
            background-image: url('https://images.unsplash.com/photo-1429552077091-836152271555?q=80&w=1000');
            animation: stormy 8s infinite;
        }
        
        .weather-info.snow::before {
            background-image: url('https://images.unsplash.com/photo-1491002052546-bf38f186af56?q=80&w=1000');
            animation: snowy 10s infinite linear;
        }
        
        .weather-info.mist::before,
        .weather-info.fog::before {
            background-image: url('https://images.unsplash.com/photo-1487621167305-5d248087c724?q=80&w=1000');
            animation: foggy 20s infinite alternate;
        }
        
        @keyframes sunny {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes cloudy {
            0% { transform: translateX(0); }
            100% { transform: translateX(-10%); }
        }
        
        @keyframes rainy {
            0% { background-position: 0 0; }
            100% { background-position: 0 20px; }
        }
        
        @keyframes stormy {
            0%, 100% { filter: brightness(0.85); }
            50% { filter: brightness(1); }
        }
        
        @keyframes snowy {
            0% { background-position: 0 0; }
            100% { background-position: 10px 20px; }
        }
        
        @keyframes foggy {
            0% { filter: brightness(0.85) blur(0); }
            100% { filter: brightness(0.95) blur(1px); }
        }
        
        .weather-main {
            font-size: 2.2rem;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .weather-date {
            font-size: 1.3rem;
            margin-bottom: 15px;
        }
        
        .weather-details {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
        }
        
        .weather-icon {
            font-size: 3rem;
            animation: float 3s infinite ease-in-out;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .weather-temp {
            font-size: 2.5rem;
            font-weight: bold;
        }
        
        .weather-desc {
            font-size: 1.3rem;
        }
        
        .sun-times {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 15px;
            font-size: 0.9rem;
            background-color: rgba(0,0,0,0.2);
            border-radius: 30px;
            padding: 8px 15px;
            width: fit-content;
            margin: 15px auto 5px auto;
        }
        
        .sunset {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .main-recommendation-container {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--primary);
            color: white;
            padding: 15px 20px;
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            gap: 15px;
        }
        
        .main-recommendation {
            flex-grow: 1;
        }
        
        .speak-button {
            background-color: white;
            color: var(--primary);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .speak-button:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .day-indicator {
            background-color: #f8d7da;
            color: #721c24;
            padding: 10px 15px;
            text-align: center;
            font-weight: bold;
            display: none;
        }
        
        .day-indicator.visible {
            display: block;
        }
        
        .weather-comparison {
            background-color: #cff4fc;
            color: #055160;
            padding: 10px 15px;
            text-align: center;
            margin-bottom: 15px;
        }
        
        [data-theme="dark"] .weather-comparison {
            background-color: #193c43;
            color: #cff4fc;
        }
        
        [data-theme="dark"] .day-indicator {
            background-color: #3e1a1d;
            color: #f8d7da;
        }
        
        .important-reminder {
            background-color: #fdebd0;
            border-left: 5px solid #f39c12;
            padding: 15px 20px;
            margin: 15px 0;
            font-weight: bold;
        }
        
        [data-theme="dark"] .important-reminder {
            background-color: #3d3525;
            color: #fdebd0;
        }
        
        .clothing-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            padding: 20px;
        }
        
        .clothing-section {
            background-color: #f0f7ff;
            padding: 20px;
            border-radius: 12px;
            border-top: 5px solid var(--primary);
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: background-color 0.3s;
        }
        
        [data-theme="dark"] .clothing-section {
            background-color: #252d3d;
        }
        
        .clothing-section h3 {
            color: var(--primary);
            margin-bottom: 15px;
            border-bottom: 2px dashed var(--primary);
            padding-bottom: 10px;
            font-size: 1.3rem;
        }
        
        .clothing-list {
            list-style-type: none;
        }
        
        .clothing-list li {
            margin: 12px 0;
            padding: 8px 40px 8px 0;
            position: relative;
            background-color: rgba(255,255,255,0.5);
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        [data-theme="dark"] .clothing-list li {
            background-color: rgba(0,0,0,0.2);
        }
        
        .clothing-list li:hover {
            background-color: rgba(255,255,255,0.9);
            transform: translateX(-5px);
        }
        
        [data-theme="dark"] .clothing-list li:hover {
            background-color: rgba(255,255,255,0.1);
        }
        
        .clothing-list li::before {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5rem;
        }
        
        /* Custom icons for each type of clothing item */
        .item-tshirt::before { content: "👕"; }
        .item-shirt::before { content: "👔"; }
        .item-sweater::before { content: "🧶"; }
        .item-jacket::before { content: "🧥"; }
        .item-coat::before { content: "🧥"; }
        
        .item-pants::before { content: "👖"; }
        .item-shorts::before { content: "🩳"; }
        .item-skirt::before { content: "👗"; }
        
        .item-hat::before { content: "🧢"; }
        .item-sunglasses::before { content: "🕶️"; }
        .item-gloves::before { content: "🧤"; }
        .item-scarf::before { content: "🧣"; }
        
        .item-shoes::before { content: "👞"; }
        .item-boots::before { content: "👢"; }
        .item-sandals::before { content: "👡"; }
        
        .item-umbrella::before { content: "☂️"; }
        .item-bag::before { content: "🎒"; }
        .item-bottle::before { content: "🧴"; }
        .item-water::before { content: "💧"; }
        .item-sunscreen::before { content: "🧴"; }
        .item-pencil::before { content: "✏️"; }
        .item-food::before { content: "🥪"; }
        
        .weather-specific {
            background-color: #ffefef;
            border-top-color: var(--secondary);
        }
        
        [data-theme="dark"] .weather-specific {
            background-color: #3d2929;
        }
        
        .weather-specific h3 {
            color: var(--secondary);
            border-bottom-color: var(--secondary);
        }
        
        .weather-changes {
            margin: 0 0 20px 0;
            border-radius: 0;
            overflow: hidden;
            display: none;
        }
        
        .weather-changes-header {
            background-color: var(--warning);
            color: white;
            padding: 15px;
            font-weight: bold;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .weather-changes-list {
            background-color: #fff3e0;
            padding: 0;
            margin: 0;
            list-style-type: none;
        }
        
        [data-theme="dark"] .weather-changes-list {
            background-color: #3d3525;
            color: #fff3e0;
        }
        
        .weather-changes-item {
            padding: 15px;
            border-bottom: 1px solid #ffe0b2;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        [data-theme="dark"] .weather-changes-item {
            border-bottom-color: #554935;
        }
        
        .weather-changes-item:last-child {
            border-bottom: none;
        }
        
        .weather-changes-icon {
            font-size: 1.8rem;
        }
        
        .weather-changes-time {
            font-weight: bold;
            margin-right: 10px;
            min-width: 80px;
        }
        
        .weather-changes-text {
            flex: 1;
        }
        
        .change-temperature-up {
            color: #e65100;
        }
        
        .change-temperature-down {
            color: #0277bd;
        }
        
        .change-rain-start {
            color: #0277bd;
        }
        
        .change-rain-end {
            color: #388e3c;
        }
        
        [data-theme="dark"] .change-temperature-up {
            color: #ffab70;
        }
        
        [data-theme="dark"] .change-temperature-down {
            color: #7bb5db;
        }
        
        [data-theme="dark"] .change-rain-start {
            color: #7bb5db;
        }
        
        [data-theme="dark"] .change-rain-end {
            color: #8aba92;
        }
        
        .error-message {
            display: none;
            background-color: #ffdddd;
            color: #d83030;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }
        
        [data-theme="dark"] .error-message {
            background-color: #582929;
            color: #ffdddd;
        }
        
        .refresh-button {
            background-color: var(--success);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 16px 32px;
            font-size: 1.2rem;
            cursor: pointer;
            margin: 25px auto;
            display: block;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            width: 80%;
            max-width: 300px;
        }
        
        .refresh-button:hover {
            background-color: #56aa64;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25);
        }
        
        [data-theme="dark"] .refresh-button:hover {
            background-color: #407a48;
        }
        
        .refresh-button:active {
            transform: translateY(1px);
        }
        
        .update-time {
            text-align: center;
            font-size: 0.9rem;
            color: #666;
            margin: 15px 0;
            padding: 0 20px;
        }
        
        [data-theme="dark"] .update-time {
            color: #aaa;
        }
        
        /* Fact of the day section */
        .fact-container {
            background-color: #e3f2fd;
            border-radius: 12px;
            padding: 20px;
            margin: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        [data-theme="dark"] .fact-container {
            background-color: #1e3a5a;
        }
        
        .fact-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .fact-content {
            margin-bottom: 15px;
            min-height: 60px;
        }
        
        .fact-button {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 8px 20px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: block;
            margin: 0 auto;
        }
        
        .fact-button:hover {
            background-color: #3a82e5;
            transform: translateY(-2px);
        }
        
        [data-theme="dark"] .fact-button:hover {
            background-color: #2c5a9e;
        }
        
        .fade-in {
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px 15px;
            color: #666;
            font-size: 0.9rem;
            background-color: var(--footer-bg);
            border-radius: 15px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
            transition: background-color 0.3s, color 0.3s;
        }
        
        [data-theme="dark"] footer {
            color: #aaa;
        }
        
        /* Theme toggle button */
        .theme-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            transition: all 0.3s;
        }
        
        .theme-toggle:hover {
            transform: rotate(30deg);
        }
        
        @media (max-width: 600px) {
            body {
                font-size: 16px;
            }
            
            .container {
                padding: 12px;
            }
            
            .clothing-container {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 15px;
            }
            
            .clothing-section {
                padding: 15px;
            }
            
            .weather-main {
                font-size: 1.8rem;
            }
            
            .weather-temp {
                font-size: 2.2rem;
            }
            
            .weather-icon {
                font-size: 2.5rem;
            }
            
            .main-recommendation-container {
                font-size: 1.1rem;
                padding: 12px 15px;
            }
            
            .refresh-button {
                padding: 14px 28px;
                font-size: 1.1rem;
                width: 90%;
            }
            
            .weather-changes-item {
                padding: 12px;
            }
            
            .weather-changes-icon {
                font-size: 1.5rem;
            }
            
            .weather-changes-time {
                min-width: 70px;
            }
            
            .theme-toggle {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
                top: 10px;
                left: 10px;
            }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" id="theme-toggle">🌓</button>
    
    <div class="container">
        <div class="loading" id="loading">
            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSI0MCIgc3Ryb2tlPSIjNEQ5NkZGIiBzdHJva2Utd2lkdGg9IjgiIGZpbGw9Im5vbmUiIHN0cm9rZS1kYXNoYXJyYXk9IjI1MSAyNDEiPjxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgdHlwZT0icm90YXRlIiBmcm9tPSIwIDUwIDUwIiB0bz0iMzYwIDUwIDUwIiBkdXI9IjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIvPjwvY2lyY2xlPjwvc3ZnPg==" alt="טוען...">
            <p>בודק את מזג האוויר למחר...</p>
        </div>
        
        <div class="error-message" id="error">
            <p>אופס! לא הצלחתי לקבל את תחזית מזג האוויר.</p>
            <p>נסה שוב מאוחר יותר!</p>
            <button class="refresh-button" onclick="window.location.reload()">נסה שוב</button>
        </div>
        
        <div class="result" id="result">
            <div class="weather-info" id="weather-info">
                <div class="weather-main" id="weather-title">מה ללבוש לבית הספר מחר?</div>
                <div class="weather-date" id="date">יום רביעי, 27 פברואר</div>
                
                <div class="weather-details">
                    <div class="weather-icon" id="weather-icon">☀️</div>
                    <div class="weather-temp" id="temperature">22°C</div>
                </div>
                
                <div class="weather-desc" id="weather-desc">בהיר</div>
                
                <div class="sun-times">
                    <div class="sunset">
                        <span>שקיעה:</span>
                        <span id="sunset-time">17:22</span>
                    </div>
                </div>
            </div>
            
            <div class="main-recommendation-container">
                <div class="main-recommendation" id="main-recommendation">
                    מומלץ ללבוש חולצה קצרה ולקחת מטריה!
                </div>
                <button class="speak-button" id="speak-button" title="השמע המלצה">🔊</button>
            </div>
            
            <div class="day-indicator" id="day-indicator">
                שים לב: מחר יום שישי! יום לימודים קצר
            </div>
            
            <div class="weather-comparison" id="weather-comparison">
                מחר יהיה קריר יותר מהיום ב-3 מעלות
            </div>
            
            <div class="weather-changes" id="weather-changes">
                <div class="weather-changes-header">
                    <span>⚠️</span>
                    <span>שינויים חשובים במזג האוויר מחר:</span>
                </div>
                <ul class="weather-changes-list" id="weather-changes-list">
                    <!-- התוכן יוכנס דינמית -->
                </ul>
            </div>
            
            <div id="weather-reminder" class="important-reminder" style="display:none">
                <span style="font-size:1.3rem; margin-left: 10px;">💧</span> זכרו לשתות הרבה מים מחר!
            </div>
            
            <div class="clothing-container" id="clothing-container">
                <!-- החלקים השונים יוכנסו דינמית -->
            </div>
            
            <div id="weather-specific-container" class="clothing-section weather-specific" style="display:none; margin: 0 20px 20px 20px;">
                <h3 id="weather-specific-title">בגלל שיהיה חם:</h3>
                <ul class="clothing-list" id="weather-specific-items">
                    <!-- התוכן יוכנס דינמית -->
                </ul>
            </div>
            
            <div class="fact-container" id="fact-container">
                <div class="fact-title">
                    <span>💡</span>
                    <span>הידעת?</span>
                </div>
                <div class="fact-content" id="fact-content">
                    הגוף שלנו מפיק חום כשקר לנו, ולכן שכבות רבות של בגדים שומרות על חום הגוף טוב יותר מבגד עבה אחד!
                </div>
                <button class="fact-button" id="fact-button">עובדה חדשה</button>
            </div>
            
            <p class="update-time" id="update-time">עודכן לאחרונה: 26 פברואר, 12:34</p>
            
            <button class="refresh-button" onclick="window.location.reload()">רענן נתונים</button>
        </div>
        
        <footer>
            <p>נוצר עבור ילדי בית הספר שרוצים לדעת מה ללבוש מחר 😊</p>
        </footer>
    </div>

    <script>
        // Weather icons mapping
        const weatherIcons = {
            'Clear': '☀️',
            'Clouds': '☁️',
            'Rain': '🌧️',
            'Drizzle': '🌦️',
            'Thunderstorm': '⛈️',
            'Snow': '❄️',
            'Mist': '🌫️',
            'Fog': '🌫️'
        };
        
        // Hebrew translations for weather conditions
        const weatherTranslations = {
            'Clear': 'בהיר',
            'Clouds': 'מעונן',
            'Rain': 'גשום',
            'Drizzle': 'טפטוף',
            'Thunderstorm': 'סופת רעמים',
            'Snow': 'שלג',
            'Mist': 'ערפל קל',
            'Fog': 'ערפל'
        };
        
        // Hebrew names for days of the week
        const daysHebrew = {
            'Monday': 'יום שני',
            'Tuesday': 'יום שלישי',
            'Wednesday': 'יום רביעי',
            'Thursday': 'יום חמישי',
            'Friday': 'יום שישי',
            'Saturday': 'שבת',
            'Sunday': 'יום ראשון'
        };
        
        // Hebrew names for months
        const monthsHebrew = {
            'January': 'ינואר',
            'February': 'פברואר',
            'March': 'מרץ',
            'April': 'אפריל',
            'May': 'מאי',
            'June': 'יוני',
            'July': 'יולי',
            'August': 'אוגוסט',
            'September': 'ספטמבר',
            'October': 'אוקטובר',
            'November': 'נובמבר',
            'December': 'דצמבר'
        };
        
        // CSS classes for different clothing items
        const clothingItemClasses = {
            // Tops
            'חולצת בית ספר קצרה': 'item-tshirt',
            'חולצת בית ספר עם שרוול ארוך': 'item-shirt',
            'חולצת טי': 'item-tshirt',
            'סוודר': 'item-sweater',
            'סוודר חם': 'item-sweater',
            'קפוצ׳ון': 'item-jacket',
            'מעיל': 'item-coat',
            'מעיל חורף': 'item-coat',
            'מעיל חורף עבה': 'item-coat',
            'מעיל עמיד למים': 'item-coat',
            
            // Bottoms
            'מכנסיים ארוכים': 'item-pants',
            'מכנסיים קצרים': 'item-shorts',
            'מכנסיים ארוכים קלים': 'item-pants',
            'מכנסיים עבים': 'item-pants',
            'חצאית': 'item-skirt',
            'חצאית עם טייץ': 'item-skirt',
            'חצאית עם גרביון': 'item-skirt',
            
            // Accessories
            'כובע': 'item-hat',
            'כובע חם': 'item-hat',
            'כובע שמש': 'item-hat',
            'משקפי שמש': 'item-sunglasses',
            'כפפות': 'item-gloves',
            'כפפות חמות': 'item-gloves',
            
            // Footwear
            'נעליים סגורות': 'item-shoes',
            'נעליים קלות': 'item-shoes',
            'מגפיים': 'item-boots',
            'מגפיים חמים': 'item-boots',
            'סנדלים': 'item-sandals',
            
            // Weather-specific items
            'מטריה': 'item-umbrella',
            'מטריה קטנה': 'item-umbrella',
            'מטריה חזקה': 'item-umbrella',
            
            // School items
            'תיק': 'item-bag',
            'תיק עם ספרים': 'item-bag',
            'בקבוק מים': 'item-water',
            'בקבוק מים גדול': 'item-water',
            'קלמר': 'item-pencil',
            'קרם הגנה': 'item-sunscreen',
            'שקית ניילון': 'item-bag',
            'ארוחת 10': 'item-food'
        };
        
        // Clothing recommendations based on temperature and gender
        const clothingRules = {
            'very_cold': {  // Below 0°C
                'tops': [
                    'חולצת בית ספר עם שרוול ארוך',
                    'סוודר חם',
                    'מעיל חורף עבה'
                ],
                'bottoms': {
                    'boys': [
                        'מכנסיים ארוכים עבים',
                        'טייץ תרמי מתחת למכנסיים'
                    ],
                    'girls': [
                        'מכנסיים ארוכים עבים',
                        'חצאית עם גרביון עבה',
                        'טייץ תרמי מתחת למכנסיים או חצאית'
                    ]
                },
                'accessories': [
                    'כפפות חמות'
                ],
                'footwear': [
                    'נעליים סגורות עם גרביים עבות'
                ],
                'school_items': [
                    'תיק עם ספרים לפי מערכת',
                    'בקבוק מים',
                    'קלמר עם כל הציוד',
                    'ארוחת 10'
                ]
            },
            'cold': {  // 0-10°C
                'tops': [
                    'חולצת בית ספר עם שרוול ארוך',
                    'סוודר',
                    'מעיל חורף'
                ],
                'bottoms': {
                    'boys': [
                        'מכנסיים ארוכים'
                    ],
                    'girls': [
                        'מכנסיים ארוכים',
                        'חצאית עם גרביון עבה'
                    ]
                },
                'accessories': [],
                'footwear': [
                    'נעליים סגורות'
                ],
                'school_items': [
                    'תיק עם ספרים לפי מערכת',
                    'בקבוק מים',
                    'קלמר עם כל הציוד',
                    'ארוחת 10'
                ]
            },
            'cool': {  // 10-18°C
                'tops': [
                    'חולצת בית ספר עם שרוול ארוך',
                    'סווטשירט או קפוצ׳ון קל'
                ],
                'bottoms': {
                    'boys': [
                        'מכנסיים ארוכים'
                    ],
                    'girls': [
                        'מכנסיים ארוכים',
                        'חצאית עם גרביון או טייץ'
                    ]
                },
                'accessories': [],
                'footwear': [
                    'נעליים סגורות'
                ],
                'school_items': [
                    'תיק עם ספרים לפי מערכת',
                    'בקבוק מים',
                    'קלמר עם כל הציוד',
                    'ארוחת 10'
                ]
            },
            'mild': {  // 18-24°C
                'tops': [
                    'חולצת בית ספר קצרה',
                    'קפוצ׳ון או סווטשירט דק (למקרה שיהיה קריר)'
                ],
                'bottoms': {
                    'boys': [
                        'מכנסיים ארוכים קלים'
                    ],
                    'girls': [
                        'מכנסיים ארוכים קלים',
                        'חצאית עם טייץ דק'
                    ]
                },
                'accessories': [],
                'footwear': [
                    'נעליים סגורות'
                ],
                'school_items': [
                    'תיק עם ספרים לפי מערכת',
                    'בקבוק מים',
                    'קלמר עם כל הציוד',
                    'ארוחת 10'
                ]
            },
            'warm': {  // 24-29°C
                'tops': [
                    'חולצת בית ספר קצרה'
                ],
                'bottoms': {
                    'boys': [
                        'מכנסיים קצרים (אם מותר בבית הספר)',
                        'מכנסיים ארוכים קלים'
                    ],
                    'girls': [
                        'מכנסיים קצרים (אם מותר בבית הספר)',
                        'מכנסיים ארוכים קלים',
                        'חצאית'
                    ]
                },
                'accessories': [
                    'כובע שמש'
                ],
                'footwear': [
                    'נעליים סגורות'
                ],
                'school_items': [
                    'תיק עם ספרים לפי מערכת',
                    'בקבוק מים גדול',
                    'קלמר עם כל הציוד',
                    'ארוחת 10'
                ]
            },
            'hot': {  // Above 29°C
                'tops': [
                    'חולצת בית ספר קצרה וקלה'
                ],
                'bottoms': {
                    'boys': [
                        'מכנסיים קצרים (אם מותר בבית הספר)',
                        'מכנסיים ארוכים קלים מאוד'
                    ],
                    'girls': [
                        'מכנסיים קצרים (אם מותר בבית הספר)',
                        'מכנסיים ארוכים קלים מאוד',
                        'חצאית'
                    ]
                },
                'accessories': [
                    'כובע שמש'
                ],
                'footwear': [
                    'סנדלים - שים/י לב לבדוק שאין שיעור ספורט מחר!'
                ],
                'school_items': [
                    'תיק עם ספרים לפי מערכת',
                    'בקבוק מים גדול (לפחות ליטר)',
                    'קלמר עם כל הציוד',
                    'ארוחת 10'
                ]
            }
        };
        
        // Weather condition specific recommendations for kids
        const weatherConditionItems = {
            'Rain': {
                'title': 'בגלל שיהיה גשום:',
                'items': [
                    'מטריה',
                    'מעיל עמיד למים',
                    'שקית ניילון לתיק (כדי שהספרים לא יירטבו)'
                ]
            },
            'Drizzle': {
                'title': 'בגלל שיהיה טפטוף:',
                'items': [
                    'מטריה קטנה',
                    'מעיל עמיד למים'
                ]
            },
            'Thunderstorm': {
                'title': 'בגלל שתהיה סופת רעמים:',
                'items': [
                    'מטריה חזקה',
                    'מעיל עמיד למים',
                    'שקית ניילון לתיק (כדי שהספרים לא יירטבו)'
                ]
            },
            'Snow': {
                'title': 'בגלל שיהיה שלג:',
                'items': [
                    'כפפות חמות',
                    'שקית ניילון לתיק (כדי שהספרים לא יירטבו)'
                ]
            },
            'Mist': {
                'title': 'בגלל שיהיה ערפל:',
                'items': [
                    'בגדים בצבעים בהירים (כדי שיראו אותך טוב)',
                    'מעיל קל'
                ]
            },
            'Fog': {
                'title': 'בגלל שיהיה ערפל סמיך:',
                'items': [
                    'בגדים בצבעים בהירים (כדי שיראו אותך טוב)',
                    'פנס קטן (אם יוצאים מוקדם בבוקר)'
                ]
            },
            'Clear': {
                'title': 'בגלל שיהיה יום שמש:',
                'items': [
                    'קרם הגנה',
                    'משקפי שמש'
                ]
            }
        };
        
        // Main recommendation texts based on weather conditions and temperature
        const mainRecommendations = {
            'Rain': {
                'cold': 'מומלץ ללבוש בגדים חמים ולקחת מטריה!',
                'cool': 'מומלץ ללבוש שכבות ולקחת מטריה!',
                'mild': 'מומלץ ללבוש בגדים עם שרוול ארוך ולקחת מטריה!',
                'warm': 'מומלץ ללבוש חולצה קצרה ולקחת מטריה!'
            },
            'Thunderstorm': {
                'cold': 'מומלץ ללבוש בגדים חמים ולקחת מטריה חזקה!',
                'cool': 'מומלץ ללבוש שכבות ולקחת מטריה חזקה!',
                'mild': 'מומלץ ללבוש בגדים עם שרוול ארוך ולקחת מטריה חזקה!',
                'warm': 'מומלץ ללבוש חולצה קצרה ולקחת מטריה חזקה!'
            },
            'Drizzle': {
                'cold': 'מומלץ ללבוש בגדים חמים ולקחת מטריה קטנה!',
                'cool': 'מומלץ ללבוש שכבות ולקחת מטריה קטנה!',
                'mild': 'מומלץ ללבוש בגדים עם שרוול ארוך ולקחת מטריה קטנה!',
                'warm': 'מומלץ ללבוש חולצה קצרה ולקחת מטריה קטנה!'
            },
            'Snow': {
                'cold': 'מומלץ ללבוש בגדים חמים במיוחד ומגפיים!',
                'cool': 'מומלץ ללבוש בגדים חמים במיוחד ומגפיים!'
            },
            'Clear': {
                'very_cold': 'מומלץ ללבוש בגדים חמים מאוד! יהיה קר מחר.',
                'cold': 'מומלץ ללבוש בגדים חמים! יהיה קר מחר.',
                'cool': 'מומלץ ללבוש שכבות! יהיה קריר מחר.',
                'mild': 'מומלץ ללבוש חולצה קלה עם שרוול!',
                'warm': 'מומלץ ללבוש חולצה קצרה וקחו בקבוק מים!',
                'hot': 'מומלץ ללבוש בגדים קלים וקחו הרבה מים!'
            },
            'Clouds': {
                'very_cold': 'מומלץ ללבוש בגדים חמים מאוד! יהיה קר ומעונן.',
                'cold': 'מומלץ ללבוש בגדים חמים! יהיה קר ומעונן.',
                'cool': 'מומלץ ללבוש שכבות! יהיה קריר ומעונן.',
                'mild': 'מומלץ ללבוש חולצה עם שרוול! יהיה מעונן.',
                'warm': 'מומלץ ללבוש חולצה קצרה! יהיה חם ומעונן.',
                'hot': 'מומלץ ללבוש בגדים קלים! יהיה חם ומעונן.'
            }
        };
        
        // Default main recommendations for temperature categories
        const defaultMainRecommendations = {
            'very_cold': 'מומלץ ללבוש בגדים חמים מאוד!',
            'cold': 'מומלץ ללבוש בגדים חמים!',
            'cool': 'מומלץ ללבוש שכבות! יהיה קריר.',
            'mild': 'מומלץ ללבוש חולצה עם שרוול!',
            'warm': 'מומלץ ללבוש חולצה קצרה וקחו בקבוק מים!',
            'hot': 'מומלץ ללבוש בגדים קלים וקחו הרבה מים!'
        };
        
        // מערך עובדות מעניינות על מזג אוויר ולבוש
        const weatherFacts = [
            "הגוף שלנו מפיק חום כשקר לנו, ולכן שכבות רבות של בגדים שומרות על חום הגוף טוב יותר מבגד עבה אחד!",
            "האם ידעתם שהתלבושת האחידה לבית הספר הומצאה באנגליה לפני יותר מ-500 שנה?",
            "ביום חם, בגדים בצבע לבן הם הכי טובים כי הם מחזירים את קרני השמש!",
            "הידעתם? ענן גשם טיפוסי שוקל בערך כמו 100 פילים!",
            "הצבע הכחול של השמיים נוצר כתוצאה מפיזור האור של השמש באטמוספירה.",
            "בסופת ברקים, אם אתם סופרים את השניות בין הברק לרעם וחלקו ב-3, תקבלו את המרחק בקילומטרים!",
            "לפני המצאת מד-הטמפרטורה, אנשים הגדירו את הטמפרטורה לפי כמה צרצרים מצייצים בדקה!",
            "כשיורד שלג, כל פתית שלג הוא בעל צורה ייחודית - אין שני פתיתים זהים!",
            "השמש מחממת את האוויר ליד פני הקרקע, והאוויר החם עולה למעלה, וכך נוצרת הרוח.",
            "ביום גשום, הצבע האדום של מטריה נראה למרחק הגדול ביותר!",
            "בקיץ, אם אתה שותה מספיק מים, הגוף שומר על טמפרטורה קבועה של 37 מעלות, גם כשבחוץ חם מאוד.",
            "הידעת? בחורף, אנחנו מאבדים כ-30% מחום הגוף דרך הראש אם הוא לא מכוסה!",
            "ביום קר, מומלץ לשתות משקאות חמים, אבל לא רותחים - הם עוזרים לגוף לשמור על חום.",
            "האם ידעתם שיש לנו יותר תאי הזעה (כ-3 מיליון) מאשר תאים שחשים את הקור?",
            "בזמן גשם, האדמה משחררת ריח מיוחד שנקרא 'פטריקור' שרבים אוהבים.",
            "הידעת? הרוח החזקה ביותר שנמדדה אי פעם הייתה במהירות של 408 קמ״ש!",
            "בגדים עם כיסים רבים הומצאו במקור עבור חיילים שהיו צריכים לשאת ציוד רב.",
            "הידעת? אם לובשים גרביים לפני השינה בלילה קר, הגוף מתחמם מהר יותר!",
            "בחורף, אם אתה לובש בגדים בשכבות, אתה יכול להסיר שכבה כשנעשה חם ולהוסיף כשקר."
        ];
        
        // OpenWeatherMap API key
        const apiKey = "64319aab490fe096e4759d3f342c1d2e";
        
        // שימוש בשם משתנה שונה מ-location (שהוא מובנה בדפדפן)
        const cityLocation = "Mazkeret Batya,IL";
        
        // DOM elements
        const loadingElement = document.getElementById('loading');
        const resultElement = document.getElementById('result');
        const errorElement = document.getElementById('error');
        const dateElement = document.getElementById('date');
        const weatherIconElement = document.getElementById('weather-icon');
        const weatherDescElement = document.getElementById('weather-desc');
        const temperatureElement = document.getElementById('temperature');
        const weatherInfoElement = document.getElementById('weather-info');
        const weatherReminderElement = document.getElementById('weather-reminder');
        const weatherChangesContainer = document.getElementById('weather-changes');
        const weatherChangesList = document.getElementById('weather-changes-list');
        const weatherSpecificContainer = document.getElementById('weather-specific-container');
        const weatherSpecificTitle = document.getElementById('weather-specific-title');
        const weatherSpecificItems = document.getElementById('weather-specific-items');
        const updateTimeElement = document.getElementById('update-time');
        const clothingContainer = document.getElementById('clothing-container');
        const mainRecommendationElement = document.getElementById('main-recommendation');
        const dayIndicatorElement = document.getElementById('day-indicator');
        const weatherComparisonElement = document.getElementById('weather-comparison');
        const sunsetTimeElement = document.getElementById('sunset-time');
        const weatherTitleElement = document.getElementById('weather-title');
        const speakButton = document.getElementById('speak-button');
        const factContentElement = document.getElementById('fact-content');
        const factButton = document.getElementById('fact-button');
        const themeToggle = document.getElementById('theme-toggle');
        
        // Gender for clothing recommendations (can be switched by user preference)
        let selectedGender = 'boys'; // Default to boys
        
        // Function to toggle dark/light theme
        function toggleTheme() {
            const body = document.body;
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
                themeToggle.textContent = '🌓';
            } else {
                body.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
                themeToggle.textContent = '☀️';
            }
        }
        
        // Initialize theme from localStorage
        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
                themeToggle.textContent = '☀️';
            }
        }
        
        // Initialize gender from localStorage
        function initGender() {
            const savedGender = localStorage.getItem('gender');
            if (savedGender) {
                selectedGender = savedGender;
            }
        }
        
        // Function to speak text using SpeechSynthesis
        function speakText(text) {
            if ('speechSynthesis' in window) {
                // Cancel any ongoing speech
                window.speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'he-IL'; // Hebrew language
                utterance.rate = 0.9; // Slightly slower rate for clarity
                
                window.speechSynthesis.speak(utterance);
            } else {
                alert('לצערנו, הדפדפן שלך לא תומך בהקראה.');
            }
        }
        
        // Function to show a random weather fact
        function showRandomFact() {
            const randomIndex = Math.floor(Math.random() * weatherFacts.length);
            factContentElement.classList.remove('fade-in');
            
            // Trigger reflow to restart animation
            void factContentElement.offsetWidth;
            
            factContentElement.textContent = weatherFacts[randomIndex];
            factContentElement.classList.add('fade-in');
        }
        
        // Load weather data when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize theme
            initTheme();
            
            // Initialize gender
            initGender();
            
            // Add event listener for theme toggle button
            themeToggle.addEventListener('click', toggleTheme);
            
            // Add event listener for speak button
            speakButton.addEventListener('click', function() {
                speakText(mainRecommendationElement.textContent);
            });
            
            // Add event listener for fact button
            factButton.addEventListener('click', showRandomFact);
            
            // Service Worker Registration for PWA
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/school-weather-app/service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registered with scope:', registration.scope);
                    })
                    .catch(error => {
                        console.error('Service Worker registration failed:', error);
                    });
            }
            
            // Load weather data
            getWeatherForecast();
        });
        
        // פונקציה שמחזירה תווית זמן ידידותית בעברית
        function getTimeLabel(hour) {
            if (hour >= 7 && hour <= 9) {
                return "בבוקר";
            } else if (hour >= 10 && hour <= 12) {
                return "לפני הצהריים";
            } else if (hour >= 13 && hour <= 14) {
                return "בצהריים";
            } else if (hour >= 15 && hour <= 18) {
                return "אחה״צ";
            } else {
                return "בערב";
            }
        }
        
        // פונקציה שמזהה שינויים משמעותיים במזג האוויר
        function detectWeatherChanges(forecasts) {
            // מסנן רק את התחזיות לשעות בית הספר (8:00-16:00)
            const schoolHoursForecasts = forecasts.filter(forecast => {
                const hour = new Date(forecast.dt * 1000).getHours();
                return hour >= 8 && hour <= 16;
            });
            
            // אם אין מספיק נתונים, מחזיר רשימה ריקה
            if (schoolHoursForecasts.length < 2) {
                return [];
            }
            
            const changes = [];
            
            // בדיקת שינויי טמפרטורה משמעותיים
            for (let i = 1; i < schoolHoursForecasts.length; i++) {
                const prevForecast = schoolHoursForecasts[i-1];
                const currentForecast = schoolHoursForecasts[i];
                
                const prevTemp = prevForecast.main.temp;
                const currentTemp = currentForecast.main.temp;
                const tempDiff = currentTemp - prevTemp;
                
                const currentHour = new Date(currentForecast.dt * 1000).getHours();
                
                // זיהוי שינוי טמפרטורה משמעותי (מעל 5 מעלות)
                if (Math.abs(tempDiff) >= 5) {
                    const timeLabel = getTimeLabel(currentHour);
                    
                    if (tempDiff > 0) {
                        changes.push({
                            type: 'temperature-up',
                            icon: '🌡️',
                            time: timeLabel,
                            text: `יתחמם משמעותית - עד ${Math.round(currentTemp)}°C`,
                            class: 'change-temperature-up'
                        });
                    } else {
                        changes.push({
                            type: 'temperature-down',
                            icon: '🌡️',
                            time: timeLabel,
                            text: `יתקרר משמעותית - עד ${Math.round(currentTemp)}°C`,
                            class: 'change-temperature-down'
                        });
                    }
                }
                
                // זיהוי תחילת או סיום גשם
                const prevWeather = prevForecast.weather[0].main;
                const currentWeather = currentForecast.weather[0].main;
                
                const isRainyWeather = weather => ['Rain', 'Drizzle', 'Thunderstorm'].includes(weather);
                
                if (!isRainyWeather(prevWeather) && isRainyWeather(currentWeather)) {
                    changes.push({
                        type: 'rain-start',
                        icon: '🌧️',
                        time: getTimeLabel(currentHour),
                        text: `צפוי להתחיל גשם בסביבות השעה ${currentHour}:00`,
                        class: 'change-rain-start'
                    });
                } else if (isRainyWeather(prevWeather) && !isRainyWeather(currentWeather)) {
                    changes.push({
                        type: 'rain-end',
                        icon: '🌦️',
                        time: getTimeLabel(currentHour),
                        text: `הגשם צפוי להיפסק בסביבות השעה ${currentHour}:00`,
                        class: 'change-rain-end'
                    });
                }
                
                // זיהוי תחילת שלג
                if (prevWeather !== 'Snow' && currentWeather === 'Snow') {
                    changes.push({
                        type: 'snow-start',
                        icon: '❄️',
                        time: getTimeLabel(currentHour),
                        text: `צפוי להתחיל שלג בסביבות השעה ${currentHour}:00`,
                        class: 'change-rain-start'
                    });
                }
            }
            
            return changes;
        }
        
        // פונקציה להשוואת הטמפרטורה של מחר לטמפרטורה של היום
        function compareTemperatures(tomorrowTemp, todayTemp) {
            const diff = Math.round(tomorrowTemp - todayTemp);
            
            if (Math.abs(diff) < 2) {
                return "מזג האוויר מחר יהיה דומה להיום";
            } else if (diff > 0) {
                return `מחר יהיה חם יותר מהיום ב-${diff} מעלות`;
            } else {
                return `מחר יהיה קריר יותר מהיום ב-${Math.abs(diff)} מעלות`;
            }
        }
        
        // פונקציה להמרת שעה מפורמט Unix Timestamp לפורמט של שעה:דקות
        function formatTime(timestamp) {
            const date = new Date(timestamp * 1000);
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            return `${hours}:${minutes}`;
        }
        
        function getWeatherForecast() {
            // הקורא להשוואה בין היום ומחר, נקבל גם את תחזית היום
            const todayUrl = `https://api.openweathermap.org/data/2.5/weather?q=${cityLocation}&appid=${apiKey}&units=metric`;
            const tomorrowUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${cityLocation}&appid=${apiKey}&units=metric&cnt=16`;
            
            // Show loading, hide results and error
            loadingElement.style.display = 'block';
            resultElement.style.display = 'none';
            errorElement.style.display = 'none';
            
            // Fetch both today's and tomorrow's forecast
            Promise.all([
                fetch(todayUrl).then(response => {
                    if (!response.ok) throw new Error('Error fetching today\'s weather');
                    return response.json();
                }),
                fetch(tomorrowUrl).then(response => {
                    if (!response.ok) throw new Error('Error fetching tomorrow\'s weather');
                    return response.json();
                })
            ])
            .then(([todayData, tomorrowData]) => {
                // Extract today's temperature and city name
                const todayTemp = todayData.main.temp;
                const cityName = todayData.name;
                const sunsetTime = formatTime(todayData.sys.sunset);
                
                // Extract tomorrow's forecasts
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                const tomorrowStr = tomorrow.toISOString().split('T')[0];
                
                // Filter forecasts for tomorrow
                const tomorrowForecasts = tomorrowData.list.filter(item => 
                    item.dt_txt.startsWith(tomorrowStr)
                );
                
                // The first forecast for tomorrow or the first available forecast
                const mainForecast = tomorrowForecasts.length > 0 ? tomorrowForecasts[0] : tomorrowData.list[0];
                
                // Create weather info object
                const weatherInfo = {
                    avgTemp: mainForecast.main.temp,
                    minTemp: mainForecast.main.temp_min,
                    maxTemp: mainForecast.main.temp_max,
                    condition: mainForecast.weather[0].main,
                    description: mainForecast.weather[0].description,
                    tomorrow: tomorrow,
                    todayTemp: todayTemp,
                    cityName: cityName,
                    sunsetTime: sunsetTime
                };
                
                // Update page title to include city name
                document.title = `מה ללבוש לבית הספר מחר? - ${cityName}`;
                
                // Update weather title to include city name
                weatherTitleElement.textContent = `מה ללבוש לבית הספר מחר ב${cityName}?`;
                
                // Display the results
                displayResults(tomorrowData.city, weatherInfo, tomorrowForecasts);
            })
            .catch(error => {
                console.error('Error:', error);
                loadingElement.style.display = 'none';
                errorElement.style.display = 'block';
            });
        }
        
        function getTemperatureCategory(temp) {
            if (temp < 0) return 'very_cold';
            if (temp < 10) return 'cold';
            if (temp < 18) return 'cool';
            if (temp < 24) return 'mild';
            if (temp < 29) return 'warm';
            return 'hot';
        }
        
        // פונקציה שמחזירה המלצה מרכזית מתאימה
        function getMainRecommendation(condition, tempCategory) {
            // בדיקה אם יש המלצה ספציפית למזג האוויר והטמפרטורה
            if (mainRecommendations[condition] && mainRecommendations[condition][tempCategory]) {
                return mainRecommendations[condition][tempCategory];
            }
            
            // אם לא, נחזיר המלצה כללית לפי טמפרטורה
            return defaultMainRecommendations[tempCategory];
        }
        
        // פונקציה להצגת הקטגוריות הלא ריקות
        function displayClothingCategories(clothing) {
            const categories = [
                { name: 'חלק עליון', items: clothing.tops, id: 'tops' },
                { name: 'חלק תחתון', items: clothing.bottoms, id: 'bottoms' },
                { name: 'אביזרים', items: clothing.accessories, id: 'accessories' },
                { name: 'הנעלה', items: clothing.footwear, id: 'footwear' },
                { name: 'ציוד לבית ספר', items: clothing.school_items, id: 'school_items' }
            ];
            
            // נקה את המכיל הקיים
            clothingContainer.innerHTML = '';
            
            // הצג רק קטגוריות עם פריטים
            categories.forEach(category => {
                if (category.items && (Array.isArray(category.items) ? category.items.length > 0 : Object.keys(category.items).length > 0)) {
                    const section = document.createElement('div');
                    section.className = 'clothing-section';
                    
                    const heading = document.createElement('h3');
                    heading.textContent = category.name;
                    
                    const list = document.createElement('ul');
                    list.className = 'clothing-list';
                    list.id = category.id;
                    
                    // בדיקה אם יש תת-קטגוריות לפי מגדר
                    if (category.id === 'bottoms' && typeof category.items === 'object' && !Array.isArray(category.items)) {
                        // השתמש בקטגוריה המגדרית הנבחרת
                        const genderItems = category.items[selectedGender] || [];
                        
                        genderItems.forEach(item => {
                            const li = document.createElement('li');
                            
                            // הוסף מחלקת CSS לפי סוג הפריט
                            for (const [itemText, className] of Object.entries(clothingItemClasses)) {
                                if (item.includes(itemText)) {
                                    li.className = className;
                                    break;
                                }
                            }
                            
                            li.textContent = item;
                            list.appendChild(li);
                        });
                    } else if (Array.isArray(category.items)) {
                        // רשימה רגילה של פריטים
                        category.items.forEach(item => {
                            const li = document.createElement('li');
                            
                            // הוסף מחלקת CSS לפי סוג הפריט
                            for (const [itemText, className] of Object.entries(clothingItemClasses)) {
                                if (item.includes(itemText)) {
                                    li.className = className;
                                    break;
                                }
                            }
                            
                            li.textContent = item;
                            list.appendChild(li);
                        });
                    }
                    
                    section.appendChild(heading);
                    section.appendChild(list);
                    clothingContainer.appendChild(section);
                }
            });
        }
        
        function displayResults(cityInfo, weatherInfo, hourlyForecasts) {
            // Format the date in Hebrew
            const tomorrow = weatherInfo.tomorrow;
            const dayName = daysHebrew[tomorrow.toLocaleDateString('en-US', { weekday: 'long' })];
            const monthName = monthsHebrew[tomorrow.toLocaleDateString('en-US', { month: 'long' })];
            const dateNum = tomorrow.getDate();
            const formattedDate = `${dayName}, ${dateNum} ${monthName}`;
            
            // Get the weather icon and translation
            const weatherIcon = weatherIcons[weatherInfo.condition] || '🌦️';
            const weatherDesc = weatherTranslations[weatherInfo.condition] || weatherInfo.condition;
            
            // Round the temperature
            const temp = Math.round(weatherInfo.avgTemp);
            
            // Get temperature category
            const tempCategory = getTemperatureCategory(temp);
            
            // Get clothing recommendations based on temperature
            const clothing = JSON.parse(JSON.stringify(clothingRules[tempCategory])); // Deep copy to avoid modifying the original
            
            // Weather-specific recommendations
            const weatherSpecific = weatherConditionItems[weatherInfo.condition] || null;
            
            // Override footwear recommendation based on weather condition
            if (['Rain', 'Thunderstorm', 'Drizzle'].includes(weatherInfo.condition)) {
                clothing.footwear = ['מגפיים - שים/י לב לבדוק שאין שיעור ספורט מחר!'];
            } else if (weatherInfo.condition === 'Snow') {
                clothing.footwear = ['מגפיים חמים - שים/י לב לבדוק שאין שיעור ספורט מחר!'];
            } else if (temp >= 29) { // Hot weather
                clothing.footwear = ['סנדלים - שים/י לב לבדוק שאין שיעור ספורט מחר!'];
            }
            
            // Show water reminder for hot days
            if (temp >= 25) {
                weatherReminderElement.style.display = 'block';
            } else {
                weatherReminderElement.style.display = 'none';
            }
            
            // Set main recommendation
            const mainRecommendation = getMainRecommendation(weatherInfo.condition, tempCategory);
            mainRecommendationElement.textContent = mainRecommendation;
            
            // Set the day indicator for Friday or Sunday
            const dayOfWeek = tomorrow.getDay();
            if (dayOfWeek === 5) { // Friday
                dayIndicatorElement.textContent = 'שים לב: מחר יום שישי! יום לימודים קצר';
                dayIndicatorElement.className = 'day-indicator visible';
            } else if (dayOfWeek === 0) { // Sunday
                dayIndicatorElement.textContent = 'שים לב: מחר יום ראשון! תחילת שבוע חדש';
                dayIndicatorElement.className = 'day-indicator visible';
            } else {
                dayIndicatorElement.className = 'day-indicator';
            }
            
            // Set weather comparison
            if (weatherInfo.todayTemp) {
                weatherComparisonElement.textContent = compareTemperatures(temp, weatherInfo.todayTemp);
            } else {
                weatherComparisonElement.style.display = 'none';
            }
            
            // Set sunset time
            sunsetTimeElement.textContent = weatherInfo.sunsetTime || '18:00';
            
            // הגדרת מחלקת רקע לפי מזג האוויר
            weatherInfoElement.className = 'weather-info ' + weatherInfo.condition.toLowerCase();
            
            // זיהוי והצגת שינויי מזג אוויר
            const weatherChanges = detectWeatherChanges(hourlyForecasts);
            
            if (weatherChanges.length > 0) {
                // יש שינויים משמעותיים - נציג אותם
                weatherChangesList.innerHTML = '';
                
                weatherChanges.forEach(change => {
                    const listItem = document.createElement('li');
                    listItem.className = 'weather-changes-item';
                    
                    const iconSpan = document.createElement('span');
                    iconSpan.className = 'weather-changes-icon';
                    iconSpan.textContent = change.icon;
                    
                    const timeSpan = document.createElement('span');
                    timeSpan.className = 'weather-changes-time';
                    timeSpan.textContent = change.time + ':';
                    
                    const textSpan = document.createElement('span');
                    textSpan.className = `weather-changes-text ${change.class}`;
                    textSpan.textContent = change.text;
                    
                    listItem.appendChild(iconSpan);
                    listItem.appendChild(timeSpan);
                    listItem.appendChild(textSpan);
                    
                    weatherChangesList.appendChild(listItem);
                });
                
                weatherChangesContainer.style.display = 'block';
            } else {
                // אין שינויים משמעותיים - נסתיר את האזור
                weatherChangesContainer.style.display = 'none';
            }
            
            // Update the DOM for basic weather info
            dateElement.textContent = formattedDate;
            weatherIconElement.textContent = weatherIcon;
            weatherDescElement.textContent = weatherDesc;
            temperatureElement.textContent = `${temp}°C`;
            
            // הצג קטגוריות לבוש כאשר מסננים את הריקות
            displayClothingCategories(clothing);
            
            // Update weather-specific items if available
            if (weatherSpecific && weatherSpecific.items.length > 0) {
                weatherSpecificTitle.textContent = weatherSpecific.title;
                
                // Clear existing items
                weatherSpecificItems.innerHTML = '';
                
                // Add new items with appropriate classes
                weatherSpecific.items.forEach(item => {
                    const li = document.createElement('li');
                    
                    // Add CSS class based on item type
                    for (const [itemText, className] of Object.entries(clothingItemClasses)) {
                        if (item.includes(itemText)) {
                            li.className = className;
                            break;
                        }
                    }
                    
                    li.textContent = item;
                    weatherSpecificItems.appendChild(li);
                });
                
                weatherSpecificContainer.style.display = 'block';
            } else {
                weatherSpecificContainer.style.display = 'none';
            }
            
            // Update last updated time
            const now = new Date();
            const day = now.getDate();
            const month = monthsHebrew[now.toLocaleDateString('en-US', { month: 'long' })];
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            updateTimeElement.textContent = `עודכן לאחרונה: ${day} ${month}, ${hours}:${minutes}`;
            
            // Show random weather fact
            showRandomFact();
            
            // Hide loading, show results
            loadingElement.style.display = 'none';
            resultElement.style.display = 'block';
        }
    </script>
    
    <!-- Service Worker Registration for PWA -->
    <script>
        // Contents for service-worker.js
        // This will be used to create a separate file
        /*
        const CACHE_NAME = 'school-weather-v1';
        const urlsToCache = [
            '/',
            '/index.html',
            '/manifest.json',
            '/favicon.ico',
            '/icons/icon-192x192.png',
            '/icons/icon-512x512.png'
        ];
        
        self.addEventListener('install', event => {
            event.waitUntil(
                caches.open(CACHE_NAME)
                .then(cache => {
                    return cache.addAll(urlsToCache);
                })
            );
        });
        
        self.addEventListener('fetch', event => {
            event.respondWith(
                caches.match(event.request)
                .then(response => {
                    if (response) {
                        return response;
                    }
                    return fetch(event.request)
                    .then(response => {
                        if (!response || response.status !== 200 || response.type !== 'basic') {
                            return response;
                        }
                        
                        const responseToCache = response.clone();
                        
                        caches.open(CACHE_NAME)
                        .then(cache => {
                            cache.put(event.request, responseToCache);
                        });
                        
                        return response;
                    });
                })
            );
        });
        
        self.addEventListener('activate', event => {
            const cacheWhitelist = [CACHE_NAME];
            event.waitUntil(
                caches.keys().then(cacheNames => {
                    return Promise.all(
                        cacheNames.map(cacheName => {
                            if (cacheWhitelist.indexOf(cacheName) === -1) {
                                return caches.delete(cacheName);
                            }
                        })
                    );
                })
            );
        });
        */
        
        // Contents for manifest.json
        // This will be used to create a separate file
        /*
        {
            "name": "מה ללבוש לבית הספר מחר?",
            "short_name": "מה ללבוש?",
            "description": "אפליקציה לילדים שעוזרת להחליט מה ללבוש לבית הספר מחר לפי מזג האוויר",
            "start_url": "/",
            "display": "standalone",
            "background_color": "#4D96FF",
            "theme_color": "#4D96FF",
            "icons": [
                {
                    "src": "icons/icon-192x192.png",
                    "sizes": "192x192",
                    "type": "image/png"
                },
                {
                    "src": "icons/icon-512x512.png",
                    "sizes": "512x512",
                    "type": "image/png"
                }
            ]
        }
        */
    </script>
</body>
</html>
